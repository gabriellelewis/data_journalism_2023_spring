---
title: "Data Analysis Project"
author: "Gabrielle Lewis"
date: "2023-04-11"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r} {r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Libraries

```{r}
options(scipen=999)
library(tidyverse)
library(lubridate)
library(janitor)
```

## Loading the data, addressing characteristics

**Answer**: The data has 20718 rows and 28 columns upon initially loading it, but the first column simply listed the row numbers, so in actuality there are 27 columns. The column names have also been cleaned up to make data analysis for this project easier. 

One clear limitation with this data is that obviously, it can't have data on every single song but every single artist ever, so this needs to be taken into consideration when analyze the dataframe and creating generalizations. There also isn't a column categorizing each row's genre, so questions asking about songs' genres will need to be slightly readjusted so that it's using data that is actually present. Some songs also have 'NA' values under columns about YouTube videos and views because no YT video exists, so these rows need to be excluded from analysis for questions asking about these columns. There are also songs that are entered into the data twice because there were multiple artists featured in the song.

In order to understand what each column name is referring to for each song, I also needed to reference the page where the dataset could be downloaded from, as this webpage includes definitions for each of the variables in the data. URL: https://www.kaggle.com/datasets/salvatorerastelli/spotify-and-youtube

```{r}
spotify_youtube_data <- read_csv('data/Spotify_Youtube.csv')

spotify_youtube_data <- spotify_youtube_data %>%
  clean_names() %>%
  select(-x1)
```


### Question 1

* **Question**: What is the average valence value for songs in the highest quartile of this data, and how does this value  compare to the average valence value for songs in the highest quartile of the number of Spotify streams and for songs in the highest quartile of the highest number of YouTube music video views?
* **Analysis summary**: In this dataset, valence is defined as the musical positiveness of a track. When looking at the highest quartile for valence values for the entire dataset, the mean valence value is about 0.84. This average value is considerably higher than the mean valence values for the respective highest quartiles for most Spotify streams and most YouTube music video views. For the quartile for songs with the most streams, the mean valence value is about 0.52, and for the quartile for songs with the most views, the mean valence value is about 0.55. It makes sense that the streams and views quartiles have similar average values because they consistent of the most popular songs.

```{r}
summary(spotify_youtube_data)

# all data average
spotify_youtube_data %>%
  filter(valence>=0.7262) %>%
  summarise(
    mean_valence=mean(valence)
  )

# stream average
spotify_youtube_data %>%
  filter(stream>=138358065, !is.na(valence)) %>%
  summarise(
    mean_valence=mean(valence)
  )

# views average
spotify_youtube_data %>%
  filter(views>=70399749) %>%
  summarise(
    mean_valence=mean(valence)
  )

```

### Question 2

* **Question**: What is the average energy value for songs in the highest quartile of this data? How many songs within the highest quartile of songs with the most Spotify streams have energy values above this average? How many songs within the highest quartile of songs with the most YouTube music video views have energy values over this average?
* **Analysis summary**: In this dataset, energy is defined as the perceptual measure of intensity and activity of a track. The average energy value for the songs in the highest energy quartile out of the entire dataset is about 0.88. Only about 10% of the songs out of the highest quartile for Spotify streams had energy values above this mean value. For songs out of the highest quartile for YouTube music views, only about 12% had energy values over this mean value.

```{r}
summary(spotify_youtube_data)

# all data average
spotify_youtube_data %>%
  filter(energy>=0.7980000) %>%
  summarise(
    mean_energy=mean(energy)
  )

# total songs in highest streams and values quartiles
spotify_youtube_data %>%
  filter(stream>=138358065) %>%
  summarise(
    total_songs=n()
  )

spotify_youtube_data %>%
  filter(views>=70399749) %>%
  summarise(
    total_songs=n()
  )

# stream average
spotify_youtube_data %>%
  filter(stream>=138358065, energy>=0.8791244) %>%
  summarise(
    total_energy_songs=n()
  ) %>%
  mutate(
    pct_energy_songs=total_energy_songs/5036*100
  )

# views average
spotify_youtube_data %>%
  filter(views>=70399749, energy>=0.8791244) %>%
  summarise(
    total_energy_songs=n()
  ) %>%
  mutate(
    pct_energy_songs=total_energy_songs/5061*100
  )
```

### Question 3 

* **Question**: Which key shows up the most in the dataset, and how large of a percentage is the most frequent key out of the entire dataset? Which key shows up the most in the highest quartile for Spotify streams and highest quartile for YouTube music video views?
* **Analysis summary**: The key value of 0, which corresponds to C, appears the most in this dataset, and songs in this key make up about 11% of the total number of rows of the data. The key value of 1, which corresponds to C sharp/D flat, appears the most in both the highest quartile for Spotify streams and highest quartile for YouTube music video views.

```{r}
spotify_youtube_data %>%
  group_by(key) %>%
  summarise(total_occurrences=n()) %>%
  arrange(desc(total_occurrences)) %>%
  mutate(pct_occurrences=total_occurrences/20718 * 100)

spotify_youtube_data %>%
  filter(stream>=138358065) %>%
  group_by(key) %>%
  summarise(total_stream_occurrences=n()) %>%
  arrange(desc(total_stream_occurrences))

spotify_youtube_data %>%
  filter(views>=70399749) %>%
  group_by(key) %>%
  summarise(total_views_occurrences=n()) %>%
  arrange(desc(total_views_occurrences))

```

### Question 4

* **Question**: What percentage of artists out of everyone in the dataset have valence values above the average value for the entire dataset? How many artists in the highest quartile of Spotify streams have valence values over the average? How many artists in the highest quartile of YouTube music video views?
* **Analysis summary**: There's a total of 2079 artists in this dataset. Out of this number, about 52% have valence values above the average valence value in the highest quartile for that specific factor. About 17% of artists above the average stream value in the highest stream quartile have a valence value over the average value. For YouTube music video views, that number is about 18.6%.

```{r}
spotify_youtube_data %>%
  group_by(artist) %>%
  summarise(count=n())

spotify_youtube_data %>%  
  filter(valence>=0.8423617) %>%
  group_by(artist) %>%
  summarise(count=n())

spotify_youtube_data %>%  
  filter(valence>=0.8423617, stream>=138358065) %>%
  group_by(artist) %>%
  summarise(count=n())

spotify_youtube_data %>%  
  filter(valence>=0.8423617, views>=70399749) %>%
  group_by(artist) %>%
  summarise(count=n())

# pct of all artists
1079/2079 * 100
# pct of top streamed artists
357/2079 * 100
# pct of top viewed artists
387/2079 * 100
```

### Question 5

* **Question**: What is the average danceability value for songs in the highest and lowest quartiles of this data? How does the average danceability value for songs in the highest Spotify streams quartile compare to these values? How about the average danceability value for the songs in the highest YouTube music video views quartile?
* **Analysis summary**: For songs in the highest and lowest quartiles of the dataset, the average danceability values respectively are about 0.81= and 0.4. For the highest Spotify streams quartile, the average danceability value is about 0.64. For the highest YouTube music video views quartile, the value is about 0.65.

```{r}
summary(spotify_youtube_data)

# calculating quartile averages
spotify_youtube_data %>%
  filter(danceability>=0.7402) %>%
  summarise(
    mean_high_danceability=mean(danceability)
  )

spotify_youtube_data %>%
  filter(0.5180>=danceability) %>%
  summarise(
    mean_low_danceability=mean(danceability)
  )

# calculating for spotify and youtube quartiles
spotify_youtube_data %>%
  filter(stream>=138358065, !is.na(danceability)) %>%
  summarise(mean_stream_danceability=mean(danceability))

spotify_youtube_data %>%
  filter(views>=70399749) %>%
  summarise(mean_views_danceability=mean(danceability))

```

